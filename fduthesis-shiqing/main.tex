% \iffalse meta-comment
%
% Copyright (C) 2018--2023 by Xiangdong Zeng <xdzeng96@gmail.com>
%
% This work may be distributed and/or modified under the
% conditions of the LaTeX Project Public License, either
% version 1.3c of this license or (at your option) any later
% version. The latest version of this license is in:
%
%   http://www.latex-project.org/lppl.txt
%
% and version 1.3 or later is part of all distributions of
% LaTeX version 2005/12/01 or later.
%
% This work has the LPPL maintenance status `maintained'.
%
% The Current Maintainer of this work is Xiangdong Zeng.
%
% \fi

%*********************************************************************
% fduthesis: 复旦大学论文模板
% 2023-05-27 v0.9a
%
% 重要提示：
%   1. 请确保使用 UTF-8 编码保存
%   2. 请使用 XeLaTeX 或 LuaLaTeX 编译
%   3. 请仔细阅读用户文档
%   4. 修改、使用、发布本文档请务必遵循 LaTeX Project Public License
%   5. 不需要的注释可以尽情删除
%*********************************************************************

\documentclass[type=master,twoside]{fduthesis}
% 模板选项：
%   type = doctor|master|bachelor  论文类型，默认为本科论文
%   oneside|twoside                论文的单双面模式，默认为 twoside
%   draft = true|false             是否开启草稿模式，默认关闭
% 带选项的用法示例：
%   \documentclass[oneside]{fduthesis}
%   \documentclass[twoside, draft=true]{fduthesis}
%   \documentclass[type=bachelor, twoside, draft=true]{fduthesis}

\fdusetup{
  % 参数设置
  % 允许采用两种方式设置选项：
  %   1. style/... = ...
  %   2. style = { ... = ... }
  % 注意事项：
  %   1. 不要出现空行
  %   2. “=” 两侧的空格会被忽略
  %   3. “/” 两侧的空格不会被忽略
  %   4. 请使用英文逗号 “,” 分隔选项
  %
  % style 类用于设置论文格式
  style = {
    % font = times,
    % 西文字体（包括数学字体）
    % 允许选项：
    %   font = garamond|libertinus|lm|palatino|times|times*|none
    %
    % cjk-font = fandol,
    % 中文字体
    % 允许选项：
    %   cjk-font = adobe|fandol|founder|mac|sinotype|sourcehan|windows|none
    %
    % 注意：
    %   1. 中文字体设置高度依赖于系统。各系统建议方案：
    %        windows：cjk-font = windows
    %        mac：    cjk-font = mac
    %        linux：  cjk-font = fandol（默认值）
    %   2. 除 fandol 和 sourcehan 外，其余字体均为商用字体，请注意版权问题
    %   3. 但 fandol 字体缺字比较严重，而 sourcehan 没有配备楷体和仿宋体
    %   4. 这里中西文字体设置均注释掉了，即使用默认设置：
    %        font     = times
    %        cjk-font = fandol
    %   5. 使用 font = none / cjk-font = none 关闭默认字体设置，需手动进行配置
    %
    % font-size = -4,
    % 字号
    % 允许选项：
    %   font-size = -4|5
    %
    % fullwidth-stop = catcode,
    % 是否把全角实心句点 “．” 作为默认的句号形状
    % 允许选项：
    %   fullwidth-stop = catcode|mapping|false
    % 说明：
    %   catcode   显式的 “。” 会被替换为 “．”（e.g. 不包括用宏定义保存的 “。”）
    %   mapping   所有的 “。” 会被替换为 “．”（使用 LuaLaTeX 编译则无效）
    %   false     不进行替换
    %
    footnote-style = xits,
    % 脚注编号样式
    % 允许选项：
    %   footnote-style = plain|libertinus|libertinus*|libertinus-sans|
    %                    pifont|pifont*|pifont-sans|pifont-sans*|
    %                    xits|xits-sans|xits-sans*
    % 默认与西文字体保持一致
    %
    % hyperlink = color,
    % 超链接样式
    % 允许选项：
    %   hyperlink = border|color|none
    %
    % hyperlink-color = default,
    % 超链接颜色
    % 允许选项：
    %   hyperlink-color = default|classic|material|graylevel|prl
    %
    bib-backend = bibtex,
    % 参考文献支持方式
    % 允许选项：
    %   bib-backend = bibtex|biblatex
    %
    % bib-style = numerical,
    % 参考文献样式
    % 允许选项：
    %   bib-style = author-year|numerical|<其他样式>
    % 说明：
    %   author-year  著者—出版年制
    %   numerical    顺序编码制
    %   <其他样式>   使用其他 .bst（bibtex）或 .bbx（biblatex）格式文件
    %
    % cite-style = {},
    % 引用样式
    % 默认为空，即与参考文献样式保持一致
    % 仅适用于 biblatex；如要填写，需保证相应的 .cbx 格式文件能被调用
    %
    bib-resource = {main.bib},
    % 参考文献数据源
    % 可以是单个文件，也可以是用英文逗号 “,” 隔开的一组文件
    % 如果使用 biblatex，则必须明确给出 .bib 后缀名
    %
    % logo = {fudan-name.pdf},
    % 封面中的校名图片
    % 模版已自带，通常不需要额外配置
    %
    % logo-size = {0.5\textwidth},      % 只设置宽度
    % logo-size = {{}, 3cm},            % 只设置高度
    % logo-size = {8cm, 3cm},           % 设置宽度和高度
    % 设置校名图片的大小
    % 通常不需要调整
    %
    % declaration-page = {declaration.pdf},
    % 插入扫描版的声明页 PDF 文档
    % 默认使用预定义的声明页，但不带签名
    %
    % auto-make-cover = true
    % 是否自动生成论文封面（封一）、指导小组成员名单（封二）和声明页（封三）
    % 除非特殊需要（e.g. 不要封面），否则不建议设为 false
  },
  %
  % info 类用于录入论文信息
  info = {
    title = {基于高维特征概率密度估计的模型不确定性研究},
    % 中文标题
    % 长标题建议使用 “\\” 命令手动换行（不是指在源文件里输入回车符，当然
    % 源文件里适当的换行可以有助于代码清晰）：
    %   title = {最高人民法院、最高人民检察院关于适用\\
     %            犯罪嫌疑人、被告人逃匿、死亡案件违法所得\\
    %            没收程序若干问题的规定},
    %
    title* = {Research on Model Uncertainty Based on High-Dimensional Feature Probability Density Estimation},
    % 英文标题
    %
    author = {师清},
    % 作者姓名
    %
    % author* = {Your name},
    % 作者姓名（英文 / 拼音）
    % 目前不需要填写
    %
    supervisor = {薛向阳\quad 教授},
    % 导师
    % 姓名与职称之间可以用 \quad 打印一个空格
    %
    major = {计算机技术},
    % 专业
    %
    degree = professional,
    % 学位类型
    % 允许选项：
    %   degree = academic|professional
    % 说明：
    %   academic      学术学位
    %   professional  专业学位
    %
    department = {计算机科学与技术},
    % 院系
    %
    student-id = {22210240262},
    % 作者学号
    %
    % date = {2023 年 1 月 1 日},
    % 日期
    % 注释掉表示使用编译日期
    %
    % secret-level = ii,
    % 密级
    % 允许选项：
    %   secret-level = none|i|ii|iii
    % 说明：
    %   none  不显示密级与保密年限
    %   i     秘密
    %   ii    机密
    %   iii   绝密
    %
    % secret-year = {五年},
    % 保密年限
    % secret-level = none 时该选项无效
    %
    instructors = {
      {薛向阳 \quad 教授},
       {李斌 \quad 教授},
      {戈维峰     \quad 青年副研究员}
    },
    % 指导小组成员
    % 使用英文逗号 “,” 分隔
    % 如有需要，可以用 \quad 手工对齐
    %
    keywords = {深度学习；模型不确定性；神经网络；高斯混合模型；域外样本检测},
    % 中文关键词
    % 使用英文逗号 “,” 分隔
    %
    keywords* = {Deep Learning; Model Uncertainty; Neural Networks; Gaussian Mixture Model; Out-of-Domain Sample Detection}
    % 英文关键词
    % 使用英文逗号 “,” 分隔
    %
    % clc = {O413.1},
    % 中图分类号
    %
    % jel = {C02},
    % JEL 分类号，仅适用于经济学院等部分院系
  }
}

% 需要的宏包可以自行调用
\usepackage{physics}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{multirow}
\usepackage{booktabs}
\usepackage{enumitem}
\usepackage{tikz}
\usetikzlibrary{positioning, arrows.meta,shadows}
\usetikzlibrary{positioning, shapes.geometric}
\usetikzlibrary{backgrounds}
\usepackage{float} %
\usepackage{makecell} % 使用 makecell 包
\usepackage{array}    % 用于表格的灵活控制
\newcolumntype{P}[1]{>{\centering\arraybackslash}p{#1}}
% 需要的命令可以自行定义
\newcommand{\hilbertH}{\symcal{H}}
\newcommand{\ee}{\symrm{e}}
\newcommand{\ii}{\symrm{i}}

\begin{document}

% 这个命令用来关闭版心底部强制对齐，可以减少不必要的 underfull \vbox 提示，但会影响排版效果
% \raggedbottom

% 前置部分包含目录、中英文摘要以及符号表等
\frontmatter

% 目录
\tableofcontents
% 插图目录
\listoffigures
% 表格目录
\listoftables

\begin{abstract}

近年来，深度学习发展迅速，凭借其卓越的算法性能在多个领域取得了广泛的应用。尽管深度学习模型在许多任务中能够达到极低的错误率，由于缺乏对预测结果置信度的量化，其在自动驾驶、医疗图像识别等安全敏感领域的应用仍然面临挑战。神经网络的模型不确定性能够反映模型对预测结果的信心程度，在预测时对高不确定性结果进行人类干预，可显著提升系统安全性。因此，神经网络模型不确定性的研究已成为深度学习实际应用中的一项重要任务。


目前，关于模型不确定性的研究提出了多种方法，如贝叶斯神经网络、模型集成和单一确定性网络建模等。贝叶斯神经网络和模型集成方法在不确定性建模方面表现优越，但通常需要多次预测或训练多个模型，导致较高的计算和存储开销。单一确定性网络建模可以通过高维特征概率密度估计来量化不确定性，该方法通过对训练集上神经网络提取的高维特征进行概率分布估计，并利用测试输入在该分布上的概率密度来表示模型不确定性。由于只需在已训练的神经网络上进行一次推理，计算和存储成本较低。然而，与贝叶斯神经网络和模型集成方法相比，该方法在不确定性建模效果上仍存在差距。为提升该方法在不确定性建模中的表现，本文提出了两种改进策略。

首先，本文通过计算对输入图像的梯度响应并可视化分析，发现域内样本和域外样本的梯度响应存在显著差异，且域外样本的响应较大。基于此本文提出对输入加上梯度相关的微小扰动，并重新计算输入在训练集所建分布上的概率密度表示模型不确定性。实验结果表明，这种方法在域外样本检测、误分类样本识别和对抗样本检测等任务中有效提升了模型不确定性的建模能力。

其次，本文提出了一种新的辅助损失函数，通过与交叉熵损失函数联合训练的方法，提高了特征空间上的类内紧密性和类间可分性，进而提升基于高维特征概率密度估计的模型不确定性建模效果。此外，由于高维特征维度过高可能带来计算和存储问题，本文提出使用主成分分析对高维特征进行降维，实验表明，在降维后的特征上进行分布建模和概率密度计算不仅可以有效降低存储空间需求，还能进一步提升模型不确定性建模效果。

综上所述，本文基于高维特征概率密度建模的方法对神经网络的模型不确定性进行了深入研究，并提出了基于输入扰动和辅助损失函数联合训练的改进方法。这些改进显著提高了对神经网络模型不确定性建模能力，推动了深度学习算法在安全敏感领域上的应用。



\end{abstract}

\begin{abstract*}
In recent years, deep learning has grown rapidly and is now widely used in many fields because of its strong performance. Although deep learning models can achieve very low error rates in many tasks, their use in safety-critical areas, such as autonomous driving and medical image recognition, still faces challenges due to the lack of confidence in predictions. Model uncertainty in neural networks shows how confident the model is in its predictions. Allowing human intervention for high-uncertainty predictions can improve system safety. As a result, research into model uncertainty in neural networks has become an important topic for real-world applications of deep learning.

Several methods have been proposed for modeling uncertainty, including Bayesian neural networks, model ensembles, and single deterministic network models. Bayesian neural networks and model ensembles perform well in uncertainty modeling, but they often require multiple predictions or the training of multiple models, leading to high computational and storage costs. Single deterministic network models can quantify uncertainty by estimating the probability density of high-dimensional features. This method estimates the probability distribution of features extracted by the neural network from the training set and uses the probability density of test inputs in that distribution to represent model uncertainty. Since it only requires a single inference on the trained neural network, it has lower computational and storage costs. However, compared to Bayesian neural networks and model ensembles, this method still has some limitations in uncertainty modeling. To improve this method, this paper suggests two improvement strategies.

First, by calculating the gradient response to input images and visualizing the results, we found that the gradient responses between in-domain and out-of-domain samples were significantly different, with out-of-domain samples showing higher responses. Based on this, we propose adding small gradient-based perturbations to the input and recalculating the probability density of the input in the distribution built on the training set to represent model uncertainty. Experimental results show that this method improves uncertainty modeling in tasks such as out-of-domain sample detection, misclassified sample identification, and adversarial sample detection.

Second, we propose a new auxiliary loss function that, when used with the cross-entropy loss function, improves the compactness of features within the same class and the separability between classes, thereby improving uncertainty modeling based on high-dimensional feature probability density estimation. Moreover, since high-dimensional features can lead to high computational and storage costs, we propose using Principal Component Analysis (PCA) to reduce feature dimensionality. Experiments show that performing distribution modeling and probability density calculation on reduced-dimensional features not only reduces storage space requirements but also improves uncertainty modeling performance.

In conclusion, this paper deeply explores model uncertainty in neural networks based on high-dimensional feature probability density modeling and proposes improvements using input perturbation and joint training with an auxiliary loss function. These improvements significantly enhance the neural network's ability to model uncertainty, advancing the use of deep learning algorithms in safety-critical fields.
\end{abstract*}

% 符号表
% 语法与 LaTeX 表格一致：列用 & 区分，行用 \\ 区分
% 如需修改格式，可以使用可选参数：
%   \begin{notation}[ll]
%     $x$ & 坐标 \\
%     $p$ & 动量
%   \end{notation}
% 可选参数与 LaTeX 标准表格的列格式说明语法一致
% 这里的 “ll” 表示两列均为自动宽度，并且左对齐
% \begin{notation}[ll]
%   $D$                  & 数据集        \\
%   $x$        & 输入 \\
%   $z$         & 高维特征
  

% \end{notation}

% 主体部分是论文的核心
\mainmatter

% 建议采用多文件编译的方式
% 比较好的做法是把每一章放进一个单独的 tex 文件里，并在这里用 \include 导入，例如
%   \include{chapter1}
%   \include{chapter2}
%   \include{chapter3}

\include{chap1}
\include{chap2}
\include{chap3}
\include{chap4}
\include{chap5}


% 附录部分
% \appendix
% 一些额外实验


% \chapter{公式推导}
% 一些公式


% 后置部分包含参考文献、声明页（自动生成）等
\backmatter

% 打印参考文献列表
\printbibliography

\begin{acknowledgements}

% 致谢内容
三年的研究生时光匆匆而过，转眼之间即将离开校园，进入人生的下一个阶段。站在人生的十字路口，告别过去，心中总是充满了些许伤感和不舍；而面对充满未知的未来，心头又总会涌上一丝恐惧。回望这三年的校园时光，仿佛如白驹过隙，转瞬已逝。有时候会想，自己到底收获了什么，又有哪些事情还没来得及做呢？最后不免感叹，时间太短，遗憾太多。许多原本在学校里想要完成的事情未能实现，收获的也少之又少。回顾这段时光，学习、科研、实习、求职，一件件事情不停地催促着自己前行，然而匆匆忙忙的日子中，却始终没有一个清晰的规划和目标，许多事情没能做到最好，令人遗憾。

在这段时光里，我特别感激父母在背后的默默支持。年轻时总以为自己可以独立飞翔，随着岁月的流逝，我越来越能体会到你们的辛劳与付出。你们的无私关怀，始终是我最坚实的后盾。正是你们的支持，使我在遇到困难时能够鼓起勇气，继续走下去。也深深感谢我的导师薛向阳教授，您对我悉心的教导和耐心的指导，让我在学习与科研的道路上受益匪浅。每当我遇到困惑时，您的建议如醍醐灌顶，拨开云雾，带给我前进的动力。您的渊博知识与严谨治学的态度，高山仰止，始终令我敬佩不已。感谢戈维峰老师的指导，很多话当时听的时候没有太放在心上，但随着时间的推移，才渐渐意识到其中的深意。虽然有些建议当时未能充分践行，但即便是其中的吉光片羽，也让我受益匪浅。感谢李斌老师在论文开题、中期汇报以及撰写过程中的细心指导，您的建议帮助我克服了许多困难。也感谢叶老师在教务工作上的辛勤付出，正因为有您，我们这些学生才能更专注于学习与科研。感谢实验室的每一位同学，优秀的你们各不相同，却都有让我学习的地方，与大家在一起的时光弥足珍贵，充满了欢乐，这无数愉快的时光，让单调的学习和科研生活也变得充满趣味。

还要感谢玉桂狗，Sanrio的顶流，天下第一可爱的宝宝，一次次被你的样子和声音治愈。感谢复旦大学江湾校区里的一草一木，这个美丽的地方给我留下了无数难忘的回忆。春天，湖边的海棠花开得灿烂；夏天，湖中荷花盛开，宛如诗画；秋天，桂花香气甜的发腻，飘在图书馆门口；冬天，草坪上茶花和腊梅冒着寒气顽强盛开。校园的每一个角落，都凝聚了我无数的回忆。相册里珍藏许多美好的画面—夏日的夕阳，天上的白云，盈缺的月亮，夜空中偶尔可见的几颗星，每一幕都让我怀念不已。还有那些天空中的精灵们——灰喜鹊、灰椋鸟、傻咕咕、小翠、白头鹎，怎么能忘记你们呢？你们婉转的鸣唱和在草坪上觅食的身影，尽管我离开了这里，这些美好的回忆也永远会留在心中。

最后，衷心感谢所有曾经给予我帮助的人。是你们的支持与鼓励，让我在学习的道路上不畏艰难，一步步走向成熟。在未来的征程中，我将继续努力，不辜负你们的期望。衷心祝愿所有的老师和朋友们，事业蒸蒸日上，身体健康，生活幸福美满！


\end{acknowledgements}

\end{document}
