%test.tex
\documentclass{article}
\usepackage[UTF8]{ctex}
\usepackage{CJKutf8}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{booktabs}
\usepackage{graphicx}
\usepackage{algorithm}
%\usepackage{algorithmic}
%\usepackage{algorithmicx}
\usepackage{algpseudocode}
\usepackage{multirow}
\usepackage{caption} % 在导言区引入 caption 宏包
\usepackage[colorlinks,linkcolor=red]{hyperref}
\title{基于高维特征概率密度建模的模型不确定性的研究}
\usepackage{listings}
\usepackage{color}
\usepackage{array}
\usepackage{makecell} % 使用 makecell 包
\usepackage{array}    % 用于表格的灵活控制
\newcolumntype{P}[1]{>{\centering\arraybackslash}p{#1}}


\begin{document}
\maketitle




\section{基于梯度空间分析和输入扰动的策略}
\subsection{GradNorm的实验结果}
\begin{table}[H]
	\centering
	\resizebox{\linewidth}{!}{
		
		\begin{tabular}{ |P{3cm}|P{3cm}|P{3cm}|  }
			\hline
			ood dataset& auroc($\uparrow$) & auprc ($\uparrow$) \\
			\hline
			svhn & 0.9480 & \textbf{0.9613} \\
			lsun &   \textbf{0.9287} & \textbf{0.9444} \\
			cifar100 & \textbf{0.9058} & \textbf{0.9242} \\
			mnist   & \textbf{0.9665 }&\textbf{ 0.9770} \\
			\hline
			
			svhn+ip&\textbf{ 0.9493} & 0.9599\\
			lsun+ip &  0.8990 & 0.9137 \\
			cifar100+ip& 0.8871 & 0.9027\\
			mnist+ip  &  0.9481 & 0.9550\\
			\hline
		\end{tabular}
	}
	\caption{
		resnet50+cafar10,accuracy=0.9489，gradNorm
	}
\end{table}


\begin{table}[H]
	\centering
	\resizebox{\linewidth}{!}{
		
		\begin{tabular}{ |P{3cm}|P{3cm}|P{3cm}|  }
			\hline
			ood dataset& auroc($\uparrow$) & auprc ($\uparrow$) \\
			\hline
			svhn & 0.9293 & 0.9516 \\
			lsun &   \textbf{0.9436} & \textbf{0.9563} \\
			cifar100 & \textbf{0.9426} & \textbf{0.9480} \\
			mnist   & \textbf{0.9550 }&\textbf{ 0.9680} \\
			\hline
			
			svhn+ip&\textbf{ 0.9467} &\textbf{ 0.9633}\\
			lsun+ip &  0.9175 & 0.9469 \\
			cifar100+ip& 0.9086 & 0.9317\\
			mnist+ip  &  0.9113 & 0.9286\\
			\hline
		\end{tabular}
	}
	\caption{
		vit+cafar10,accuracy=0.9600，gradNorm
	}
\end{table}

\subsection{Cifar加入输入扰动前后对比}
\begin{table}[H]
	\centering
	\resizebox{\linewidth}{!}{
		
		\begin{tabular}{ |P{3cm}|P{3cm}|P{3cm}|  }
			\hline
			ood dataset& auroc($\uparrow$)  & auprc($\uparrow$)  \\
			\hline
			svhn & \textbf{0.9221} & \textbf{0.9432} \\
			lsun &   0.9363 & 0.9528 \\
			cifar100 & 0.8861 & \textbf{0.9028} \\
			mnist   & 0.9189 & 0.9369 \\
			tiny-imagenet & 0.9318 & 0.9479 \\
			\hline
			
			svhn+ip& 0.9216 & 0.9411\\
			lsun+ip & \textbf{ 0.9394} & \textbf{0.9533} \\
			cifar100+ip& \textbf{ 0.8885} & 0.9009\\
			mnist+ip  &  \textbf{0.9637} & \textbf{0.9666}\\
			tiny-imagenet+ip& \textbf{ 0.9397} & \textbf{0.9493}\\
			\hline
		\end{tabular}
	}
	\caption{
		vgg16+cafar10,accuracy=0.9405
	}
\end{table}



\begin{table}[H]
	\centering
	\resizebox{\linewidth}{!}{
		
		\begin{tabular}{ |P{3cm}|P{3cm}|P{3cm}|  }
			\hline
			ood dataset& auroc($\uparrow$) & auprc ($\uparrow$) \\
			\hline
			svhn & 0.9480 & 0.9613 \\
			lsun &   0.9365 & 0.9497 \\
			cifar100 & 0.9068 & 0.9257 \\
			mnist   & 0.9774 & 0.9845 \\
			tiny-imagenet & 0.9469 & 0.9580 \\
			\hline
			
			svhn+ip&\textbf{ 0.9735} & \textbf{0.9769}\\
			lsun+ip & \textbf{ 0.9671} & \textbf{0.9716} \\
			cifar100+ip& \textbf{ 0.9171} & \textbf{0.9372}\\
			mnist+ip  &  \textbf{0.9939} & \textbf{0.9957}\\
			tiny-imagenet+ip& \textbf{ 0.9676} & \textbf{0.9731}\\
			\hline
		\end{tabular}
	}
	\caption{
		resnet50+cafar10,D=2048,accuracy=0.9489
	}
\end{table}

\begin{table}[H]
	\centering
	\resizebox{\linewidth}{!}{
		
		\begin{tabular}{ |P{3cm}|P{3cm}|P{3cm}|  }
			\hline
			ood dataset& auroc($\uparrow$)  & auprc($\uparrow$)  \\
			\hline
			svhn & 0.9685 & 0.9768 \\
			lsun &   0.9720 & 0.9788 \\
			cifar100 & 0.9400 & 0.9514 \\
			mnist   & 0.9906 & 0.9929 \\
			tiny-imagenet & 0.9747 & 0.9803 \\
			\hline
			
			svhn+ip& \textbf{0.9891} & \textbf{0.9904}\\
			lsun+ip & \textbf{ 0.9811} & \textbf{0.9830} \\
			cifar100+ip& \textbf{ 0.9497} & \textbf{0.9585}\\
			mnist+ip  &  \textbf{0.9978} & \textbf{0.9982}\\
			tiny-imagenet+ip& \textbf{ 0.9836} & \textbf{0.9861}\\
			\hline
		\end{tabular}
	}
	\caption{
		wideResnet+cafar10,accuracy=0.9650
	}
\end{table}


\begin{table}[H]
	\centering
	\resizebox{\linewidth}{!}{
		
		\begin{tabular}{ |P{3cm}|P{3cm}|P{3cm}|  }
			\hline
			ood dataset& auroc($\uparrow$)  & auprc($\uparrow$)  \\
			\hline
			svhn & 0.9293 & 0.9516 \\
			lsun &   0.9436 & 0.9563 \\
			cifar100 & 0.9426 & 0.9480 \\
			mnist   & 0.9550 & 0.9680 \\
			tiny-imagenet & 0.9330 & 0.9367 \\
			\hline
			
			svhn+ip& \textbf{0.9728} & \textbf{0.9793}\\
			lsun+ip & \textbf{ 0.9688} & \textbf{0.9740} \\
			cifar100+ip& \textbf{ 0.9463} & \textbf{0.9495}\\
			mnist+ip  &  \textbf{0.9904} & \textbf{0.9926}\\
			tiny-imagenet+ip& \textbf{ 0.9546} & \textbf{0.9545}\\
			\hline
		\end{tabular}
	}
	\caption{
		vit+cafar10,accuracy=0.9600
	}
\end{table}

\subsection{几种方法的对比}
\begin{table}[H]
	\captionsetup{labelformat=empty}
	\centering
	\resizebox{\linewidth}{!}{
		\begin{tabular}{|c|c|c|c|}
			\hline
			Method & OOD Dataset &  AUROC($\uparrow$) & AUROC($\uparrow$) \\
			\hline
			\multirow{3}{*}{baseline} 
			& cifar100 & 0.8786 & 0.8774 \\
			& lsun & 0.8952 & 0.8997 \\
			& mnist & 0.9434 & 0.9524 \\
			& svhn & 0.9271 & 0.9405 \\
			\hline
			\multirow{3}{*}{ensemble} 
			& cifar100 & 0.9244 & 0.9166 \\
			& lsun & 0.9724 & 0.9685 \\
			& mnist & 0.9735 & 0.9706 \\
			& svhn & 0.9667 & 0.9599 \\
			\hline
			\multirow{3}{*}{ddu}
			& cifar100 & 0.9068 & 0.9257 \\
			& lsun & 0.9365 & 0.9497 \\
			& mnist & 0.9774 & 0.9845 \\
			& svhn & 0.9480 & 0.9613 \\
			\hline
			\multirow{3}{*}{ddu+ip} 
			& cifar100 & 0.9171 & 0.9312 \\
			& lsun & 0.9671 & 0.9716 \\
			& mnist & 0.9939 & 0.9957 \\
			& svhn & 0.9735 & 0.9769 \\
			\hline
		\end{tabular}
	}
	\caption{
		resnet50+cafar10,D=2048,accuracy=0.9540
	}
\end{table}



\subsection{mnist加入输入扰动前后对比}
\begin{table}[H]
	\centering
	\resizebox{\linewidth}{!}{	
		\begin{tabular}{ |P{3cm}|P{3cm}|P{3cm}|  }
			\hline
			ood dataset& auroc($\uparrow$)  & auprc($\uparrow$)  \\
			\hline
			cifar10 & 0.9949 & 0.9964 \\
			fashionmnist &   0.9914 & 0.9933 \\
			fer2013 & 0.9952 & 0.9969 \\
			lsun   & 0.9946 & 0.9962 \\
			cifar100 & 0.9945 & 0.9961 \\
			svhn & 0.9941 & 0.9960 \\
			\hline
			
			cifar10+ip&\textbf{ 0.9965} &\textbf{ 0.9974}\\
			fashionmnist+ip & \textbf{ 0.9921} & \textbf{0.9936} \\
			fer2013+ip& \textbf{ 0.9970} & \textbf{0.9978}\\
			svhn+ip  &  \textbf{0.9963} & \textbf{0.9972}\\
			cifar10+ip& \textbf{ 0.9961} & \textbf{0.9970}\\
			svhn+ip & 0.9964 & 0.9973 \\
			\hline
		\end{tabular}
	}
	\caption{
		vgg16+mnist,accuracy=0.9882
	}
\end{table}


\begin{table}[H]
	\centering
	\resizebox{\linewidth}{!}{
		\begin{tabular}{ |P{3cm}|P{3cm}|P{3cm}|  }
			\hline
			ood dataset& auroc($\uparrow$)  & auprc($\uparrow$)  \\
			\hline
			cifar10 & 0.9949 & 0.9964 \\
			fashionmnist &   0.9914 & 0.9933 \\
			fer2013 & 0.9952 & 0.9969 \\
			lsun   & 0.9946 & 0.9962 \\
			cifar100 & 0.9945 & 0.9961 \\
			svhn & 0.9941 & 0.9960 \\
			\hline
			
			cifar10+ip&\textbf{ 0.9965} &\textbf{ 0.9974}\\
			fashionmnist+ip & \textbf{ 0.9921} & \textbf{0.9936} \\
			fer2013+ip& \textbf{ 0.9970} & \textbf{0.9978}\\
			svhn+ip  &  \textbf{0.9963} & \textbf{0.9972}\\
			cifar10+ip& \textbf{ 0.9961} & \textbf{0.9970}\\
			svhn+ip & 0.9964 & 0.9973 \\
			\hline
		\end{tabular}
	}
	\caption{
		resnet50+mnist,accuracy=0.9870
	}
\end{table}



\subsection{GMM vs KDE 实验结果}
\begin{table}[H]
	\centering
	\resizebox{\linewidth}{!}{
		
		\begin{tabular}{|P{3cm}|P{3cm}|P{3cm}|}
			\hline
			ood dataset& auroc($\uparrow$)  & auprc($\uparrow$)  \\
			\hline
			svhn+gmm & \textbf{0.9458} & \textbf{0.9564} \\
			lsun+gmm &   \textbf{0.9287} & \textbf{0.9444} \\
			cifar100+gmm & \textbf{ 0.9058 }& \textbf{0.9242} \\
			mnist +gmm  & \textbf{0.9665} & \textbf{0.9770} \\
			tiny-imagenet+gmm & \textbf{0.8932} & \textbf{0.9112} \\
			\hline
			
			svhn+kde& 0.7924 & 0.8365\\
			lsun+kde &  0.7894 & 0.8264 \\
			cifar100+kde& 0.7772 & 0.8097\\
			mnist+kde  &  0.8364 & 0.8684 \\
			tiny-imagenet+kde& 0.7653 & 0.7950\\
			\hline
		\end{tabular}
	}
	\caption{
		resnet50+cafar10,GMM vs KDE ,Dimension=2048,accuracy=0.9489
	}
\end{table}


\begin{table}[H]
	\centering
	\resizebox{\linewidth}{!}{
		
		\begin{tabular}{ |P{3cm}|P{3cm}|P{3cm}|  }
			\hline
			ood dataset& auroc($\uparrow$)  & auprc($\uparrow$)  \\
			\hline
			svhn+gmm & 0.9320 & 0.9530 \\
			lsun+gmm &   \textbf{0.9302} & \textbf{0.9471} \\
			cifar100+gmm & \textbf{ 0.9014 }& \textbf{0.9156} \\
			mnist +gmm  & 0.9358 & 0.9563 \\
			tiny-imagenet+gmm & \textbf{0.9026} & \textbf{0.9162} \\
			\hline
			
			svhn+kde& \textbf{0.9528} & \textbf{0.9620}\\
			lsun+kde &  0.9179 & 0.9299 \\
			cifar100+kde& 0.8923 & 0.9022\\
			mnist+kde  &  \textbf{0.9654} & \textbf{0.9718} \\
			tiny-imagenet+kde& 0.8975 & 0.8975\\
			\hline
		\end{tabular}
	}
	\caption{
		resnet50+cafar10,GMM vs KDE ,Dimension=1024,accuracy=0.9504
	}
\end{table}

\begin{table}[H]
	\centering
	\resizebox{\linewidth}{!}{
		
		\begin{tabular}{ |P{3cm}|P{3cm}|P{3cm}|  }
			\hline
			ood dataset& auroc($\uparrow$)  & auprc($\uparrow$)  \\
			\hline
			svhn+gmm & 0.9364 & 0.9553 \\
			lsun+gmm &   \textbf{0.9322} & \textbf{0.9474} \\
			cifar100+gmm & \textbf{ 0.9028 }& \textbf{0.9156} \\
			mnist +gmm  & 0.9378 & 0.9567 \\
			tiny-imagenet+gmm & \textbf{0.9038} & \textbf{0.9133} \\
			\hline
			
			svhn+kde& \textbf{0.9484} & \textbf{0.9584}\\
			lsun+kde &  0.9211 & 0.9312 \\
			cifar100+kde& 0.8957 & 0.9019\\
			mnist+kde  &  \textbf{0.9662} & \textbf{0.9732} \\
			tiny-imagenet+kde& 0.9018 & 0.8992\\
			\hline
		\end{tabular}
	}
	\caption{
		resnet50+cafar10,GMM vs KDE ,Dimension=512,accuracy=0.9520
	}
\end{table}

\begin{table}[H]
	\centering
	\resizebox{\linewidth}{!}{
		
		\begin{tabular}{ |P{3cm}|P{3cm}|P{3cm}|  }
			\hline
			ood dataset& auroc($\uparrow$)  & auprc($\uparrow$)  \\
			\hline
			svhn+gmm & 0.9418 & 0.9594 \\
			lsun+gmm &   \textbf{0.9277} & \textbf{0.9417} \\
			cifar100+gmm &  0.8983 & 0.9073 \\
			mnist +gmm  & 0.9450 & 0.9628 \\
			tiny-imagenet+gmm & 0.9013 & 0.9066 \\
			\hline
			
			svhn+kde& \textbf{0.9569} & \textbf{0.9659}\\
			lsun+kde &  0.9230 & 0.9399 \\
			cifar100+kde& \textbf{0.8992} & \textbf{0.9090}\\
			mnist+kde  &  \textbf{0.9730} & \textbf{0.9790} \\
			tiny-imagenet+kde& \textbf{0.9097} & \textbf{0.9099}\\
			\hline
		\end{tabular}
	}
	\caption{
		resnet50+cafar10,GMM vs KDE ,Dimension=256,accuracy=0.9540
	}
\end{table}


\begin{table}[H]
	\centering
	\resizebox{\linewidth}{!}{
		
		\begin{tabular}{ |P{3cm}|P{3cm}|P{3cm}|  }
			\hline
			ood dataset& auroc($\uparrow$)  & auprc($\uparrow$)  \\
			\hline
			svhn+gmm & \textbf{0.9222} & \textbf{0.9433} \\
			lsun+gmm &   \textbf{0.9077} & \textbf{0.9204} \\
			cifar100+gmm & \textbf{ 0.8848 }& \textbf{0.9018} \\
			mnist +gmm  & 0.9141 & 0.9308 \\
			tiny-imagenet+gmm & \textbf{0.8807} & \textbf{0.8847} \\
			\hline
			
			svhn+kde& \textbf{0.9230} & \textbf{0.9362}\\
			lsun+kde &  0.9047 & 0.9137 \\
			cifar100+kde& 0.8778 & 0.8845\\
			mnist+kde  &  \textbf{0.9377}& \textbf{0.9456} \\
			tiny-imagenet+kde& 0.8750 & 0.8643\\
			\hline
		\end{tabular}
	}
	\caption{
		vgg16+cafar10,GMM vs KDE ,Dimension=512,accuracy=0.9489
	}
\end{table}





\subsection{扰动前后做差}
\begin{table}[H]
	\centering
	\resizebox{\linewidth}{!}{
		
		\begin{tabular}{ |P{3cm}|P{3cm}|P{3cm}|  }
			\hline
			ood dataset& auroc($\uparrow$) & auprc ($\uparrow$) \\
			\hline
			svhn & \textbf{0.9221} & \textbf{0.9432} \\
			lsun &  \textbf{ 0.9078} & \textbf{0.9205} \\
			cifar100 & \textbf{0.8848} &\textbf{ 0.9018} \\
			mnist   & \textbf{0.9140} &\textbf{ 0.9308 }\\
			tiny-imagenet &\textbf{ 0.8807} & \textbf{0.8847} \\
			\hline
			
			svhn+ip& 0.8884  & 0.8952 \\
			lsun+ip &  0.8400  & 0.8488  \\
			cifar100+ip&  0.8603  & 0.8606 \\
			mnist+ip  &  0.8715  & 0.8757 \\
			tiny-imagenet+ip&  0.8549  & 0.8637 \\
			\hline
		\end{tabular}
	}
	\caption{
		vgg16+cafar10,扰动前概率密度 vs (扰动后概率密度-扰动前概率密度),accuracy=0.9407
	}
\end{table}


\subsection{关于高维特征维度的实验结果}
\begin{table}[H]
	\centering
	\resizebox{\linewidth}{!}{
		
		\begin{tabular}{ |P{3cm}|P{3cm}|P{3cm}|  }
			\hline
			ood dataset& auroc($\uparrow$) & auprc ($\uparrow$) \\
			\hline
			svhn & 0.9480 & 0.9613 \\
			lsun &   0.9365 & 0.9497 \\
			cifar100 & 0.9068 & 0.9257 \\
			mnist   & 0.9774 & 0.9845 \\
			tiny-imagenet & 0.9469 & 0.9580 \\
			\hline
			
			svhn+ip&\textbf{ 0.9735} & \textbf{0.9769}\\
			lsun+ip & \textbf{ 0.9671} & \textbf{0.9716} \\
			cifar100+ip& \textbf{ 0.9171} & \textbf{0.9372}\\
			mnist+ip  &  \textbf{0.9939} & \textbf{0.9957}\\
			tiny-imagenet+ip& \textbf{ 0.9676} & \textbf{0.9731}\\
			\hline
		\end{tabular}
	}
	\caption{
		resnet50+cafar10,D=2048,accuracy=0.9489
	}
\end{table}
\begin{table}[H]
	\centering
	\resizebox{\linewidth}{!}{
		
		\begin{tabular}{ |P{3cm}|P{3cm}|P{3cm}|  }
			\hline
			ood dataset& auroc($\uparrow$) & auprc ($\uparrow$) \\
			\hline
			svhn & 0.9303 & 0.9528 \\
			lsun &   0.9325 & 0.9515 \\
			cifar100 & 0.9085 & 0.9279 \\
			mnist   & 0.9358 & 0.9564 \\
			tiny-imagenet & 0.9028 & 0.9167 \\
			\hline
			
			svhn+ip&\textbf{ 0.9777} & \textbf{0.9822}\\
			lsun+ip & \textbf{ 0.9544} & \textbf{0.9647} \\
			cifar100+ip& \textbf{ 0.9203} & \textbf{0.9343}\\
			mnist+ip  &  \textbf{0.9837} & \textbf{0.9885}\\
			tiny-imagenet+ip& \textbf{0.9150} & \textbf{0.9249 }\\
			\hline
		\end{tabular}
	}
	\caption{
		resnet50+cafar10,D=1024,accuracy=0.9504
	}
\end{table}

\begin{table}[H]
	\centering
	\resizebox{\linewidth}{!}{
		
		\begin{tabular}{ |P{3cm}|P{3cm}|P{3cm}|  }
			\hline
			ood dataset& auroc($\uparrow$) & auprc ($\uparrow$) \\
			\hline
			svhn & 0.9343 & 0.9454 \\
			lsun &   0.9334 & 0.9501 \\
			cifar100 & 0.9094 & 0.9272 \\
			mnist   & 0.9387 & 0.9582 \\
			tiny-imagenet & 0.9049 & 0.9146 \\
			\hline
			
			svhn+ip&\textbf{ 0.9786} & \textbf{0.9828}\\
			lsun+ip & \textbf{ 0.9535} & \textbf{0.9632} \\
			cifar100+ip& \textbf{ 0.9191} & \textbf{0.9301}\\
			mnist+ip  &  \textbf{0.9840} & \textbf{0.9887}\\
			tiny-imagenet+ip& \textbf{0.9134} & \textbf{0.9193} \\
			\hline
		\end{tabular}
	}
	\caption{
		resnet50+cafar10,D=512,accuracy=0.9520
	}
\end{table}

\begin{table}[H]
	\centering
	\resizebox{\linewidth}{!}{
		
		\begin{tabular}{ |P{3cm}|P{3cm}|P{3cm}|  }
			\hline
			ood dataset& auroc($\uparrow$) & auprc ($\uparrow$) \\
			\hline
			svhn & 0.9418 & 0.9596 \\
			lsun &   0.9307 & 0.9470 \\
			cifar100 & 0.9081 & 0.9231 \\
			mnist   & 0.9451 & 0.9629 \\
			tiny-imagenet & 0.9026 & \textbf{0.9091} \\
			\hline
			
			svhn+ip&\textbf{ 0.9763} & \textbf{0.9819}\\
			lsun+ip & \textbf{ 0.9434} & \textbf{0.9534} \\
			cifar100+ip& \textbf{ 0.9098} & \textbf{0.9201}\\
			mnist+ip  &  \textbf{0.9832} & \textbf{0.9886}\\
			tiny-imagenet+ip& \textbf{0.9056 }& 0.9070 \\
			\hline
		\end{tabular}
	}
	\caption{
		resnet50+cafar10,D=256,accuracy=0.9540
	}
\end{table}

\subsection{各种方法的对比}
\begin{table}[H]
		\captionsetup{labelformat=empty}
	\centering
	\resizebox{\linewidth}{!}{
\begin{tabular}{|c|c|c|c|}
\hline
Method & OOD Dataset &  AUROC($\uparrow$) & AUROC($\uparrow$) \\
\hline
\multirow{3}{*}{baseline} 
& cifar100 & 0.8786 & 0.8774 \\
& lsun & 0.8952 & 0.8997 \\
& mnist & 0.9434 & 0.9524 \\
& svhn & 0.9271 & 0.9405 \\
\hline
\multirow{3}{*}{ensemble} 
& cifar100 & 0.9244 & 0.9166 \\
& lsun & 0.9724 & 0.9685 \\
& mnist & 0.9735 & 0.9706 \\
& svhn & 0.9667 & 0.9599 \\
\hline
\multirow{3}{*}{ddu}
& cifar100 & 0.9068 & 0.9257 \\
& lsun & 0.9365 & 0.9497 \\
& mnist & 0.9774 & 0.9845 \\
& svhn & 0.9480 & 0.9613 \\
\hline
\multirow{3}{*}{ddu+ip} 
& cifar100 & 0.9171 & 0.9312 \\
& lsun & 0.9671 & 0.9716 \\
& mnist & 0.9939 & 0.9957 \\
& svhn & 0.9735 & 0.9769 \\
\hline
\end{tabular}
}
	\caption{
	resnet50+cafar10,D=2048,accuracy=0.9540
}

\end{table}




\subsection{对抗样本检测}
\begin{table}[H]
	\captionsetup{labelformat=empty}
	\centering
	\begin{tabular}{|ll|rr|}
		\hline
		\multicolumn{2}{|c|}{Input} & \multicolumn{2}{c|}{Result}  \\
		\hline
		Method      & Attack Method  & AUROC($\uparrow$)  & AUROC($\uparrow$)   \\
		\hline
		\multirow{4}{*}{DDU} 
		& FGSM & 0.8428 & 0.8394 \\
		& BIM  & 0.8070 & 0.8816 \\
		& PGD  & 0.7420 & 0.8021 \\
		\hline
		\multirow{4}{*}{GMM+Input Perturbation} 
		& FGSM & \textbf{0.8882} & \textbf{0.9737} \\
		& BIM   & \textbf{0.8559} & \textbf{0.9686} \\
		& PGD   & \textbf{0.8433} & \textbf{0.9700} \\
		\hline
	\end{tabular}
	\caption{VGG16 + CIFAR10, 对抗样本的检测任务}
\end{table}

\section{辅助loss}
\subsection{加入辅助Loss前后对比}
\begin{table}[H]
	\captionsetup{labelformat=empty}
	\centering
	\renewcommand{\arraystretch}{1.2} % 增加行高，提高可读性
	\setlength{\tabcolsep}{8pt} % 调整列间距
	\begin{tabular}{|c|c|c|c|}
		\hline
		\multicolumn{2}{|c|}{\textbf{实验设置}} & \multicolumn{2}{c|}{\textbf{实验结果}} \\ 
		\hline
		\textbf{训练策略} & \textbf{OOD Dataset} & \textbf{ AUROC($\uparrow$)} & \textbf{ AUPRC ($\uparrow$)} \\ 
		\hline
		\multirow{4}{*}{CE loss} 
		& svhn      & 0.9195 & 0.9412 \\ 
		& lsun      & 0.9144 & \textbf{ 0.9317} \\ 
		& cifar100  & 0.8865 & 0.8966 \\ 
		& mnist     & 0.9240 & 0.9426 \\ 
		\hline
		\multirow{4}{*}{CE loss +ContrastiveCenterLoss}
		& svhn      & \textbf{ 0.9332} & \textbf{0.9517} \\ 
		& lsun      & \textbf{ 0.9221} & 0.9270 \\ 
		& cifar100  & \textbf{ 0.8952} & \textbf{0.9065} \\ 
		& mnist     & \textbf{0.9395} & \textbf{0.9579} \\ 
		\hline
	\end{tabular}
	\caption{实验设置：Vgg16+cafar10,D=512,accuracy=0.9438}
\end{table}



\begin{table}[H]
	\captionsetup{labelformat=empty}
	\centering
	\renewcommand{\arraystretch}{1.2} % 增加行高，提高可读性
	\setlength{\tabcolsep}{8pt} % 调整列间距
	\begin{tabular}{|c|c|c|c|}
		\hline
		\multicolumn{2}{|c|}{\textbf{实验设置}} & \multicolumn{2}{c|}{\textbf{实验结果}} \\ 
		\hline
		\textbf{训练策略} & \textbf{OOD Dataset} & \textbf{ AUROC($\uparrow$)} & \textbf{ AUPRC ($\uparrow$)} \\ 
		\hline
		\multirow{4}{*}{CE loss} 
		&	svhn & 0.9260 & 0.9437 \\
		&	lsun &   0.9290 &\textbf{0.9445} \\
		&	cifar100 & 0.9036 & 0.9124 \\
		&	mnist   & 0.9176 & 0.9268 \\
		\hline
		\multirow{4}{*}{CE loss + ContrastiveCenterLoss}
		&	svhn&\textbf{0.9410} & \textbf{ 0.9554}\\
		&	lsun & \textbf{0.9329} & 0.9415 \\
		&	cifar100&  \textbf{0.9115} &\textbf{ 0.9177}\\
		&	mnist  &  \textbf{0.9501} & \textbf{0.9636}\\
		\hline
	\end{tabular}
	\caption{实验设置：ResNet18+cafar10,D=512,accuracy=0.9438}
\end{table}


\begin{table}[H]
	\captionsetup{labelformat=empty}
	\centering
	\renewcommand{\arraystretch}{1.2} % 增加行高，提高可读性
	\setlength{\tabcolsep}{8pt} % 调整列间距
	\begin{tabular}{|c|c|c|c|}
		\hline
		\multicolumn{2}{|c|}{\textbf{实验设置}} & \multicolumn{2}{c|}{\textbf{实验结果}} \\ 
		\hline
		\textbf{训练策略} & \textbf{OOD Dataset} & \textbf{ AUROC($\uparrow$)} & \textbf{ AUPRC ($\uparrow$)} \\ 
		\hline
		\multirow{4}{*}{CE loss} 
		&	svhn & 0.9007 & 0.9008 \\
		&	lsun &   0.9727 & 0.9716 \\
		&	cifar100 & 0.8960 & 0.8966 \\
		&	mnist   & 0.8913 & 0.9123 \\
		\hline
		\multirow{4}{*}{CE loss + ContrastiveCenterLoss}
		&	svhn&\textbf{0.9874} & \textbf{ 0.9910}\\
		&	lsun & \textbf{0.9891} & \textbf{0.9916} \\
		&	cifar100&  \textbf{0.9668} &\textbf{ 0.9704}\\
		&	mnist  &  \textbf{0.9930} & \textbf{0.9939}\\
		\hline
	\end{tabular}
	\caption{实验设置：VIT+cafar10,accuracy=0.9780}
\end{table}



\section{其他}
\subsection{一些公式}
\textbf{Input Purturbation:}\\
\\
\\
添加输入扰动的方式如下:
$$\tilde{x}=x+\epsilon* \cdot sign(\nabla_x U(x))$$
\\GMM的公式
其中:
$$U(x)=\log p(x)$$
$$p(x)=\max_{c}N(x|\mu_c,\Sigma_c)=\max_{c} \frac{1}{(2\pi)^{D/2}}\frac{1}{\left| \Sigma_c \right|^{1/2}}exp\left\{-\frac{1}{2}(x-\mu_c)^T\Sigma_c^{-1}(x-\mu_c)\right\}$$
超参数$\epsilon$通过gridSearch得到.
\\
\\
\\
\textbf{GMM的公式：}
$$
N(x|\mu_c,\Sigma_c)=\frac{1}{(2\pi)^{D/2}}\frac{1}{\left| \Sigma_c \right|^{1/2}}exp\left\{-\frac{1}{2}(x-\mu_c)^T\Sigma_c^{-1}(x-\mu_c)\right\}$$
$$p(x)  = \sum_{c=1}^{K}w_cN(x|\mu_c,\Sigma_c)$$

$
\\
\\
\\
$
$\tilde{x}=x-\epsilon \cdot sign(-\nabla_x \log p(x;D))$

a
\\
\\
\\
\textbf{centerloss的公式：}
$$
L_c = \frac{1}{2}\sum_{i=1}^{m}\Vert x_i-x_{y_i}\Vert_2^2
$$

$$
L_s:CrossEntropyLoss
$$

$$
L = L_s+L_c
$$


修正后的centerloss:
$$
L_c = \frac{1}{2}\sum_{i=1}^{m} \frac{\Vert x_i-x_{y_i}\Vert_2^2}{\sum_{j=1,j\neq y_i}^{m}\Vert x_i-x_j\Vert_2^2+\delta}
$$




\subsection{算法流程图}
\begin{algorithm}[h]
	\caption{基于输入扰动的概率密度建模的模型不确定性算法}
	\label{alg:1}
	
	\begin{algorithmic}[1]
		\Require 训练集: $(X,Y)$ 
		\Require 谱归一化的高维特征提取网络: $f_{\theta}:x \rightarrow \mathbf{R}^d $ 
		\Require GMM模型: $q(z) = \sum_{y}q(z|y=c)q(y=c)$
		
		\\
		\Procedure {1.训练阶段}{}
		\State 在训练数据集数据集上训练网络$f_{\theta}$
		\For {属于类别c的样本}
		\State $\mu_{c}=\frac{1}{|x_c|}f_{\theta}(x_c)$
		\State $\Sigma_c = \frac{1}{|x_c|-1}(f_{\theta}(x_c)-\mu_c)(f_{\theta}(x_c)-\mu_c)^T$
		\State q(y=c)=$\frac{|X_C|}{|X|}$
		\EndFor
		\EndProcedure

		
		\\
		\Procedure {2.模型不确定性计算}{}
		\State $z=f_{\theta}(x)$
		\State  $q(z) = \sum_{y}q(z|y=c)q(y=c)$,其中$q(z)\sim N(\mu_c,\Sigma_c)$
		\State $\tilde{x}=x+\epsilon* \cdot sign(\nabla_x \log q(z)))$,其中$\epsilon$通过grid search调参
		\State $\tilde{z}=f_{\theta}(\tilde{x})$
		\State 计算模型不确定性 $Uncertainty(x) = \sum_{y}q(\tilde{z}|y=c)q(y=c)$,其中$q(\tilde{z})\sim N(\mu_c,\Sigma_c)$
		\EndProcedure
	\end{algorithmic}
\end{algorithm}
%



\end{document}